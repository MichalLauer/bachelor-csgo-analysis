# Globální nastavení
```{r }
data("mtcars")
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
library(kableExtra)
```
# Vyčištění prostředí
```{r }
folder <- "plots"
unlink(folder, recursive = T)
dir.create(folder)
folder <- paste0(folder, "/")
```
# Sloupcový graf
```{r }
mtcars |>
  mutate(cyl = as.factor(cyl)) |>
  ggplot(aes(x = cyl, y = hp, fill = cyl)) +
  geom_bar(show.legend = F, stat = "summary", fun = mean) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank()) +
  labs(
    title = "Porovnání válců s průměrbou hrubou koňskou silou",
    caption = "Henderson and Velleman (1981)",
    x = "Počet válců",
    y = "Průměrná hrubá koňská síla"
  )

ggsave(paste0(folder, "sloupcovy_graf.png"), bg = "white",
       width = 140, height = 105, units = 'mm')
```
# Porovnání histogramů
```{r}
hg <- \(bins) {
  width <- round((max(mtcars$mpg) - min(mtcars$mpg))/bins, 2)
  mtcars |>
    ggplot(aes(x = mpg)) +
    geom_histogram(bins = bins, binwidth = width) +
    theme_minimal() +
    scale_y_continuous(limits = c(0, 7)) +
    theme(panel.grid.major.x = element_blank(),
          plot.title = element_text(size = 10),
          plot.subtitle  = element_text(size = 8),
          axis.title.x = element_text(size = 8),
          axis.title.y = element_text(size = 8)
          ) +
    labs(
      title = "Histogram míle z galon",
      subtitle = paste0("Počet skupin: ", bins, ", ",
                        "Šířka skupiny: ", width),
      caption = "Henderson and Velleman (1981)",
      x = "Míle za galon",
      y = "Počet pozorování"
    )
}

h1 <- hg(10)
h2 <- hg(20)
h3 <- hg(30)
h4 <- hg(40)

hg <- arrangeGrob(h1 + labs(caption = ""),
                  h2 + labs(caption = ""),
                  h3 + labs(caption = ""),
                  h4, nrow = 2)

ggsave(paste0(folder, "histogram_porovnani.png"),
  plot = hg, bg = "white",
  width = 140, height = 105, units = "mm"
)
```
# Histogram dle Sturgese
```{r}
bins <- ceiling(1 + 3.22*log10(nrow(mtcars)))
width <- round((max(mtcars$mpg) - min(mtcars$mpg))/bins, 2)
hg <- mtcars |>
  ggplot(aes(x = mpg)) +
  geom_histogram(bins = bins) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank()) +
  labs(
      title = "Histogram míle z galon",
      subtitle = paste0("Počet skupin: ", bins, ", ",
                        "Šířka skupiny: ", width),
      caption = "Henderson and Velleman (1981)",
      x = "Míle za galon",
      y = "Počet pozorování"
    )
hg
ggsave(paste0(folder, "histogram.png"), bg = "white",
       width = 140, height = 105, units = 'mm')
```
# Histogram dle Sturgese v tabulce
```{r, results='asis'}
ggplot_build(hg)$data[1] |>
  as.data.frame() |>
  select(xmin, xmax, count) |>
  kbl(caption="Tabulka četnostní",
      label = "tab:tabulka_cetnosti_sturges",
      format="latex",
      col.names = c("Spodní hranice intervalu", "Horní hranice intervalu", "Počet pozorování"),
      align="c") %>%
  kable_minimal(full_width = F,  html_font = "Source Sans Pro") |>
  writeLines()
```
