V této části je každý dataset nahrán a zpracován. Proměnné se 

## Soubor economy.csv
Jelikož soubor obsahuje pouze data z průběhu zápasu, soubor pro naší analýzu nelze využít. Logistický model bude zaměřen především na předpovědi a šance ještě před tím, než zápas začne.

## Soubor picks.csv
Soubor *picks.csv* obsahuje detaily o tom, jaký team si vybral či zabanoval jakou mapu v jakém zápase. Dataset k logistickému modelu nejspíše nevyužijeme, ale bude se hodit pro finální simluaci zápasů.

```{r picks-load}
removed_cols <- c('date', 'inverted_teams', 'match_id', 'event_id', 'best_of', 'system')

picks <- read_csv("data/picks.csv", show_col_types = FALSE,
                  col_select = -all_of(removed_cols)) %>%
  na_if(y = '0.0') %>%
  mutate(across(.fns = factor))
  

sample_n(picks, 5)
```

V dataset se po načtění provedli následující změny:

- Odstraněné sloupce: *`r removed_cols`*

```{r picks-cleanup}
rm(removed_cols)
```
## Soubor players.csv
*players.csv* obsahuje statistiky hráčů pro jednotlivé zápasy. 
```{r players-load}
relevant_stats <- c('kills', 'deaths', 'adr', 'rating')

players.raw <- read_csv('data/players.csv', show_col_types = F,
                        col_select = c(player_name, team, starts_with('map_'),
                                       contains(relevant_stats)))

players <- 1:3 %>% 
  map_dfr(function(n) {
    player_map <- paste0('map_', n)
    stats <- paste0('m', n, '_', relevant_stats)
    players.raw %>%
      select(player_name, all_of(player_map), all_of(stats)) %>%
      rename(player = player_name,
             map = starts_with('map_')) %>%
      rename_with(.fn = ~ gsub('m._', '', .x)) %>%
      drop_na()
    }) %>%
  filter(map != 'Default') %>%
  mutate(across(.col = c('player', 'map'), .fns = factor))

sample_n(players, 5)
```

Změny

- Odstraněny mapy s názvem *Default*
- Vybrány statistiky: `r relevant_stats`

```{r players-cleanup}
rm(players.raw, relevant_stats)
```

## Soubor results.csv
Tento soubor obsahuje konkrétní výsledky zápasu. Jsou zde i informace o průběhu *(např. stav zápasu v polovině)*, pro nás je ovšem důležitý pouze konečný výsledek.
```{r results-load}
selected_cols <- c('team_1', 'team_2', 'map' = '_map', 'map_winner', 'starting_ct', 'rank_1', 'rank_2')
results <- read_csv('data/results.csv', show_col_types = F, col_select = all_of(selected_cols)) %>% 
  mutate(map_winner = ifelse(map_winner == 1, team_1, team_2),
         starting_ct = ifelse(starting_ct == 1, team_1, team_2))

sample_n(results, 5)
```
Změny
- Odstraněno 21 záznamů kde je mapa Default

```{r results-cleanup}
rm(selected_cols)
```